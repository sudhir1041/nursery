

{% comment %} --- Determine badge class, icon, and text based on status --- {% endcomment %}
{% with status_lower=status|lower|default:"unknown" %} {# Convert status to lowercase once #}

    {% comment %} --- Render the badge directly within each condition --- {% endcomment %}
    {% if status_lower == 'draft' %}
        <span class="status-badge status-draft" title="Draft">
            <i class="fas fa-pencil-alt"></i> Draft
        </span>
    {% elif status_lower == 'pending' %}
        <span class="status-badge status-pending" title="Pending">
            <i class="fas fa-clock"></i> Pending
        </span>
    {% elif status_lower == 'scheduled' %}
        <span class="status-badge status-scheduled" title="Scheduled{% if scheduled_time %} for {{ scheduled_time|date:'Y-m-d H:i' }}{% endif %}">
            <i class="fas fa-calendar-alt"></i> Scheduled
        </span>
    {% elif status_lower == 'sending' or status_lower == 'processing' %}
         <span class="status-badge status-sending" title="Sending">
             <i class="fas fa-paper-plane"></i> Sending
         </span>
    {% elif status_lower == 'completed' or status_lower == 'sent' %}
         <span class="status-badge status-completed" title="Sent">
             <i class="fas fa-check-double"></i> Sent
         </span>
    {% elif status_lower == 'delivered' %}
         {# Ensure status-delivered class exists in your CSS if you need a distinct style #}
         <span class="status-badge status-delivered" title="Delivered">
             <i class="fas fa-check-double"></i> Delivered
         </span>
    {% elif status_lower == 'read' %}
         {# Ensure status-read class exists in your CSS if you need a distinct style #}
         <span class="status-badge status-read" title="Read">
             <i class="fas fa-eye"></i> Read
         </span>
    {% elif status_lower == 'failed' or status_lower == 'error' %}
         <span class="status-badge status-failed" title="Failed">
             <i class="fas fa-exclamation-circle"></i> Failed
         </span>
    {% elif status_lower == 'cancelled' %}
         {# Ensure status-cancelled class exists in your CSS #}
         <span class="status-badge status-cancelled" title="Cancelled">
             <i class="fas fa-ban"></i> Cancelled
         </span>
    {% elif status_lower == 'paused' %}
         <span class="status-badge status-paused" title="Paused">
             <i class="fas fa-pause-circle"></i> Paused
         </span>
    {% elif status_lower == 'active' %} {# For Bot/AutoReply status #}
         <span class="status-badge status-active" title="Active">
             <i class="fas fa-check-circle"></i> Active
         </span>
    {% elif status_lower == 'inactive' %} {# For Bot/AutoReply status #}
         {# Ensure status-inactive class exists in your CSS #}
         <span class="status-badge status-inactive" title="Inactive">
             <i class="fas fa-times-circle"></i> Inactive
         </span>
    {% else %} {# Fallback #}
         {# Ensure status-unknown class exists in your CSS #}
         <span class="status-badge status-unknown" title="{{ status|default:'Unknown Status' }}">
             <i class="fas fa-question-circle"></i> {{ status|capfirst|default:"Unknown" }}
         </span>
    {% endif %}

{% endwith %} 
