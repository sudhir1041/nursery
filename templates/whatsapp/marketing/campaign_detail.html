{# whatsapp_app/templates/whatsapp_app/marketing/campaign_detail.html #}
{% extends "whatsapp/base_whatsapp.html" %} {# Extend the non-Bootstrap WhatsApp base #}
{% load static %}

{% block whatsapp_content %}
<div class="whatsapp-detail-container"> {# Custom container for detail pages #}

    {# Header Section #}
    <div class="detail-header">
        <div class="detail-title-status">
            <h3 class="page-title">{{ campaign.name }}</h3>
             {# Use the status badge partial #}
            {% include "whatsapp/partials/status_badge.html" with status=campaign.status scheduled_time=campaign.scheduled_time %}
        </div>
        <div class="detail-actions">
            {# Placeholder for primary actions like Schedule/Send/Pause based on status #}
            {% if campaign.status == 'DRAFT' %}
                 <a href="#" class="custom-button button-success"><i class="fas fa-calendar-alt"></i> Schedule</a>
                 <a href="#" class="custom-button button-primary"><i class="fas fa-paper-plane"></i> Send Now</a>
            {% elif campaign.status == 'SCHEDULED' %}
                 <a href="#" class="custom-button button-warning"><i class="fas fa-pause-circle"></i> Pause</a>
                 <a href="#" class="custom-button button-secondary"><i class="fas fa-edit"></i> Edit Schedule</a>
            {% elif campaign.status == 'SENDING' %}
                 <a href="#" class="custom-button button-warning"><i class="fas fa-pause-circle"></i> Pause</a>
            {% elif campaign.status == 'PAUSED' %}
                 <a href="#" class="custom-button button-success"><i class="fas fa-play-circle"></i> Resume</a>
            {% endif %}
             {# Add other actions like Edit, Delete later #}
             {# <a href="{% url 'whatsapp_app:campaign_edit' campaign.pk %}" class="custom-button button-outline-secondary button-sm"><i class="fas fa-edit"></i> Edit</a> #}
        </div>
    </div>
     <p class="page-description">Manage contacts, scheduling, and view performance for this campaign.</p>
    <hr class="divider">

    {# Display general messages #}
    {% if messages %}
    <div class="whatsapp-messages-container mb-4">
        {% for message in messages %}
        <div class="message-item message-{{ message.tags|default:'info' }}">
            {{ message }}
            <button type="button" class="message-close-btn" onclick="this.parentElement.style.display='none'">&times;</button>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    {# --- Campaign Details Section --- #}
    <div class="detail-section">
        <h4 class="section-title">Campaign Setup</h4>
        <dl class="definition-list"> {# Use definition list for details #}
            <dt>Template Used:</dt>
            <dd>
                {% if campaign.template %}
                    {{ campaign.template.name }} ({{ campaign.template.category }})
                    {# Optional: Link to template preview #}
                    {# <a href="{% url 'whatsapp_app:template_detail' campaign.template.pk %}" class="action-link-sm"><i class="fas fa-eye"></i> Preview</a> #}
                {% else %}
                    <span class="text-muted">N/A</span>
                {% endif %}
            </dd>

            <dt>Created On:</dt>
            <dd>{{ campaign.created_at|date:"F j, Y, P" }}</dd>

            <dt>Last Updated:</dt>
            <dd>{{ campaign.updated_at|date:"F j, Y, P" }}</dd>

            <dt>Scheduled Time:</dt>
            <dd>{{ campaign.scheduled_time|date:"F j, Y, P"|default:"Not Scheduled" }}</dd>

            <dt>Started Sending:</dt>
            <dd>{{ campaign.started_at|date:"F j, Y, P"|default:"Not Started" }}</dd>

            <dt>Finished Sending:</dt>
            <dd>{{ campaign.finished_at|date:"F j, Y, P"|default:"Not Finished" }}</dd>

        </dl>
    </div>

    {# --- Placeholder Sections for Future Functionality --- #}

    {# Contacts Section #}
    <div class="detail-section">
         <div class="section-header">
            <h4 class="section-title">Recipients</h4>
             {# Add button only if in draft/paused state? #}
            {% if campaign.status == 'DRAFT' or campaign.status == 'PAUSED' %}
                <a href="#" class="custom-button button-outline-secondary button-sm">
                    <i class="fas fa-users"></i> Manage Recipients
                </a>
            {% endif %}
         </div>
        <div class="placeholder-content">
            <p class="text-muted">Recipient management (uploading CSV, selecting lists) will be available here.</p>
            {# Example: <p>Total Recipients: {{ contacts_count|default:0 }}</p> #}
        </div>
    </div>

     {# Performance Section #}
    <div class="detail-section">
         <div class="section-header">
            <h4 class="section-title">Performance</h4>
             {# Add button only if campaign has run #}
             {% if campaign.status != 'DRAFT' and campaign.status != 'SCHEDULED' %}
                <a href="#" class="custom-button button-outline-secondary button-sm">
                    <i class="fas fa-chart-bar"></i> View Full Report
                </a>
            {% endif %}
         </div>
        <div class="placeholder-content">
             <p class="text-muted">Campaign statistics (Sent, Delivered, Read, Failed) will be displayed here once the campaign runs.</p>
             {# Example: <p>Sent: {{ sent_count|default:0 }} | Delivered: ... | Read: ... </p> #}
        </div>
    </div>


</div> {# End whatsapp-detail-container #}
{% endblock %}
