{# whatsapp_app/templates/whatsapp_app/base_whatsapp.html #}
{# This template extends your main project's base template. #}
{# *** IMPORTANT: Replace 'base.html' with the actual path to your main project's base template *** #}
{% extends "base.html" %}
{% load static %} {# Load static tag library #}

{% block title %}WhatsApp - {{ block.super }}{% endblock title %} {# Append to the existing title #}

{# --- ADD CSS/FONTS SPECIFIC TO WHATSAPP SECTION --- #}
{% block extra_head %} {# Use a block often available in base templates for head additions #}
    {{ block.super }} {# Include anything from the parent block #}
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="{% static 'whatsapp_app/css/whatsapp_style.css' %}">

    {# Example: Link to Bootstrap Icons if not already in base.html #}
    {# <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css"> #}
{% endblock extra_head %}


{% block content %} {# Override the main content block from your base template #}
<div class="container-fluid mt-3 mb-5"> {# Use container-fluid for full width, adjust as needed #}

    {# --- WhatsApp Section Header & Navigation --- #}
    <div class="d-flex justify-content-between align-items-center mb-3 border-bottom pb-2">
        <h2 class="h4">WhatsApp Integration</h2>
        {# Optional: Add breadcrumbs here if your base template supports it #}
    </div>

    {# Sub-navigation specific to the WhatsApp section #}
    <ul class="nav nav-pills mb-4">
        <li class="nav-item">
            {# Check if the current URL name matches the dashboard URL #}
            <a class="nav-link {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}"
               href="{% url 'whatsapp_app:whatsapp_index' %}">
               <i class="bi bi-speedometer2 me-1"></i> Dashboard {# Example using Bootstrap Icons #}
            </a>
        </li>
        <li class="nav-item">
             {# Check if the current URL name is related to chats #}
            <a class="nav-link {% if request.resolver_match.url_name == 'chat_list' or request.resolver_match.url_name == 'chat_detail' %}active{% endif %}"
               href="{% url 'whatsapp_app:chat_list' %}">
               <i class="bi bi-chat-dots me-1"></i> Chats
            </a>
        </li>
        <li class="nav-item dropdown">
             {# Check if the current view name contains 'marketing' #}
             <a class="nav-link dropdown-toggle {% if 'marketing' in request.resolver_match.view_name|stringformat:"s" %}active{% endif %}"
                data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">
                <i class="bi bi-megaphone me-1"></i> Marketing
             </a>
             <ul class="dropdown-menu">
               <li><a class="dropdown-item" href="{% url 'whatsapp_app:campaign_list' %}">Campaigns</a></li>
               <li><a class="dropdown-item" href="{% url 'whatsapp_app:template_list' %}">Templates</a></li>
             </ul>
        </li>
         <li class="nav-item">
             {# Check if the current URL name matches the settings URL #}
            <a class="nav-link {% if request.resolver_match.url_name == 'settings' %}active{% endif %}"
               href="{% url 'whatsapp_app:settings' %}">
               <i class="bi bi-gear me-1"></i> Settings
            </a>
        </li>
        {# Add links for Bots/AutoReply management views if you create them #}
        {# Example:
        <li class="nav-item">
            <a class="nav-link {% if 'bot_' in request.resolver_match.url_name %}active{% endif %}"
               href="{% url 'whatsapp_app:bot_list' %}">
               <i class="bi bi-robot me-1"></i> Bots
            </a>
        </li>
         <li class="nav-item">
            <a class="nav-link {% if request.resolver_match.url_name == 'autoreply_settings' %}active{% endif %}"
               href="{% url 'whatsapp_app:autoreply_settings' %}">
               <i class="bi bi-reply me-1"></i> Auto-Reply
            </a>
        </li>
        #}
    </ul>

    {# --- Display Django Messages --- #}
    {% if messages %}
        {% for message in messages %}
            {# Use Bootstrap alert classes based on message tags (e.g., success, error, warning, info) #}
            <div class="alert alert-{{ message.tags|default:'info' }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        {% endfor %}
    {% endif %}

    {# --- Main Content Area for Specific WhatsApp Pages --- #}
    {# Child templates will override this block #}
    {% block whatsapp_content %}
        <p>Welcome to the WhatsApp Integration section.</p>
    {% endblock whatsapp_content %}

</div> {# End container #}
{% endblock content %}

{% block extra_js %} {# Allow child templates to add specific JavaScript #}
    {{ block.super }} {# Include JS from the base template #}
    {# Add any JavaScript needed across all WhatsApp pages here #}
{% endblock extra_js %}

{# extra_css block removed as CSS is now linked in extra_head #}

